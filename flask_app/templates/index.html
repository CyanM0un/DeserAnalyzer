{% extends "base.html" %}

{% block title %}GCSCAN - 反序列化漏洞检测平台{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/seamless-slider.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/tech-intro.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/dynamic-table.css') }}">
{% endblock %}

{% block content %}
    <!-- 系统简介 -->
    <section class="section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 d-flex justify-content-center ps-lg-4">
                    <img src="{{ url_for('static', filename='images/1.png') }}" alt="反序列化漏洞检测系统" class="img-fluid rounded shadow w-75">
                </div>

                <div class="col-lg-6 d-flex align-items-center">
                    <div class="text-center text-lg-start">
                        <h2 class="display-4 fw-bold mb-4" style="color: var(--primary-blue);">
                            Gadget Chain - 检测与防护:
                        </h2>
                        <p class="lead fs-5" style="color: var(--text-dark);">
                            抵御反序列化漏洞风险
                        </p>
                        <a href="{{ url_for('analyze') }}" class="btn btn-lg mt-3" style="width: 200px; background-color: var(--primary-blue); color: white;">
                            开始使用
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" style="background-color: #f8f9fa; padding: 60px 0;">
        <div class="container">
            <div class="row justify-content-center mb-5">
                <div class="col-lg-8 text-center">
                    <h2 class="section-title fw-bold">抵御反序列化漏洞风险</h2>
                </div>
            </div>
            
            <div class="row g-5">
                <!-- 漏洞危害 -->
                <div class="col-lg-6">
                    <div class="bg-white p-5 rounded shadow h-100">
                        <div class="d-flex align-items-center mb-4">
                            <div class="feature-icon me-4" style="color: #dc3545;">
                                <i class="fas fa-exclamation-triangle fa-3x"></i>
                            </div>
                            <h3 class="fw-bold mb-0" style="font-size: 1.8rem; letter-spacing: 0.5px; color: #2d3436; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">
                                反序列化漏洞危害严重
                            </h3>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex align-items-start">
                                <i class="fas fa-check-circle text-danger mt-1 me-3"></i>
                                <div>
                                    <strong>后果严重</strong>
                                    <p class="mb-0 text-muted">攻击者可通过精心构造的恶意数据，造成多种攻击，如命令执行、文件操作、权限提升等</p>
                                </div>
                            </li>
                            <li class="list-group-item d-flex align-items-start">
                                <i class="fas fa-check-circle text-danger mt-1 me-3"></i>
                                <div>
                                    <strong>影响广泛</strong>
                                    <p class="mb-0 text-muted">反序列化漏洞属于2024 CWE Top 10之一，占到Java应用检测漏洞的30%</p>
                                </div>
                            </li>
                            <li class="list-group-item d-flex align-items-start">
                                <i class="fas fa-check-circle text-danger mt-1 me-3"></i>
                                <div>
                                    <strong>隐蔽性高</strong>
                                    <p class="mb-0 text-muted">漏洞利用链拥有多种组合方式，十分灵活隐蔽</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- 平台意义 -->
                <div class="col-lg-6">
                    <div class="bg-white p-5 rounded shadow h-100">
                        <div class="d-flex align-items-center mb-4">
                            <div class="feature-icon me-4" style="color: #28a745;">
                                <i class="fas fa-shield-alt fa-3x"></i>
                            </div>
                            <h3 class="fw-bold mb-0" style="font-size: 1.8rem; letter-spacing: 0.5px; color: #2d3436; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">
                                本平台的核心价值
                            </h3>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex align-items-start">
                                <i class="fas fa-check-circle text-success mt-1 me-3"></i>
                                <div>
                                    <strong>更全面的静态分析检测</strong>
                                    <p class="mb-0 text-muted">在漏洞被利用前检测出应用潜在的漏洞利用链，防患于未然</p>
                                </div>
                            </li>
                            <li class="list-group-item d-flex align-items-start">
                                <i class="fas fa-check-circle text-success mt-1 me-3"></i>
                                <div>
                                    <strong>多语言跨适配能力</strong>
                                    <p class="mb-0 text-muted">本平台支持PHP，Java项目的检测，未来预计支持更多的语言框架</p>
                                </div>
                            </li>
                            <li class="list-group-item d-flex align-items-start">
                                <i class="fas fa-check-circle text-success mt-1 me-3"></i>
                                <div>
                                    <strong>可视化漏洞链溯源分析</strong>
                                    <p class="mb-0 text-muted">直观展示漏洞调用路径与风险节点，并且使用AI模型辅助漏洞决策</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 主要功能 -->
    <section class="section py-10">
        <div class="container">
            <div class="row justify-content-center mb-10">
                <div class="col-lg-8 text-center">
                    <h2 class="section-title fw-bold" style="font-size: 2.2rem;">核心功能</h2>
                </div>
            </div>
            <div class="row g-8 justify-content-center">
                <!-- 扫描功能 -->
                <div class="col-lg-2 col-md-5 text-center">
                    <div class="feature-icon mb-4 p-4 rounded-circle bg-primary/10" style="width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-search fa-2x text-primary"></i>
                    </div>
                    <h5 class="fw-bold mb-3 mt-3" style="font-size: 1.25rem;">漏洞链检测</h5>
                    <p class="text-muted" style="font-size: 1rem; line-height: 1.5;">更精确的静态分析助力全面检测反序列化漏洞链</p>
                </div>
                
                <!-- 链接分析 -->
                <div class="col-lg-2 col-md-5 text-center">
                    <div class="feature-icon mb-4 p-4 rounded-circle bg-primary/10" style="width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-link fa-2x text-primary"></i>
                    </div>
                    <h5 class="fw-bold mb-3 mt-3" style="font-size: 1.25rem;">利用链分析</h5>
                    <p class="text-muted" style="font-size: 1rem; line-height: 1.5;">在线审计+AI辅助深度分析漏洞利用链</p>
                </div>
                
                <!-- 实时监控 -->
                <div class="col-lg-2 col-md-5 text-center">
                    <div class="feature-icon mb-4 p-4 rounded-circle bg-primary/10" style="width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-eye fa-2x text-primary"></i>
                    </div>
                    <h5 class="fw-bold mb-3 mt-3" style="font-size: 1.25rem;">实时监控</h5>
                    <p class="text-muted" style="font-size: 1rem; line-height: 1.5;">全时段漏洞分析与安全状态监控</p>
                </div>
                
                <!-- 报告生成 -->
                <div class="col-lg-2 col-md-5 text-center">
                    <div class="feature-icon mb-4 p-4 rounded-circle bg-primary/10" style="width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-file-alt fa-2x text-primary"></i>
                    </div>
                    <h5 class="fw-bold mb-3 mt-3" style="font-size: 1.25rem;">宏观统计</h5>
                    <p class="text-muted" style="font-size: 1rem; line-height: 1.5;">多维度可视化报表呈现漏洞趋势宏观统计</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 技术简介 -->
    <section class="section">
        <div class="container">
            <div class="row justify-content-center mb-5">
                <div class="col-lg-8 text-center">
                    <h2 class="section-title fw-bold">技术概要</h2>
                </div>
                
                <!-- 技术介绍模块 -->
                <div class="tech-intro-container row mt-5">
                    <!-- 左侧索引 -->
                    <div class="tech-nav col-md-3">
                        <ul class="nav-list list-unstyled">
                            <li class="nav-item active" data-target="tech1">基于AST模拟执行的PHP Gadget Chain检测</li>
                            <li class="nav-item" data-target="tech2">基于反序列化引导调用图构建的Java Gadget Chain检测</li>
                        </ul>
                    </div>
                    
                    <!-- 右侧内容 -->
                    <div class="tech-content col-md-9">
                        <!-- 技术1 -->
                        <div class="content-item active" id="tech1">
                            <div class="content-header">
                                <i class="fas fa-code me-3"></i>
                                <h3 class="tech-title">基于AST模拟执行的PHP Gadget Chain检测</h3>
                            </div>
                            <div class="tech-desc">
                                <p>本系统基于<a href="https://github.com/HACHp1/PFortifier" target="_blank">PFortifier</a>工具进行PHP项目的Gadget Chain检测。PFortifier首先会先解析所有类、trait、接口与方法，建立类→方法和方法名→实现类的映射；随后其基于常见的反序列化入口（__unserialize、__destruct、__wakeup）进行模拟执行并标记可控对象做污点传播。为处理分支与动态调用，PFortifier采用局部变量抽象、分支克隆与贪心合并（优先保留含可控对象的分支）等策略，并通过PM_summary按方法名与参数可控性缓存合并结果与检测到的链以加速分析。</p>
                                <img src="assets/images/php-workflow.png" alt="PFortifier流程图" style="max-width:100%; height:auto; margin-top:10px;">
                            </div>
                        </div>
                        
                        <!-- 技术2 -->
                        <div class="content-item" id="tech2">
                            <div class="content-header">
                                <i class="fas fa-code me-3"></i>
                                <h3 class="tech-title">基于反序列化引导调用图构建的Java Gadget Chain检测</h3>
                            </div>
                            <div class="tech-desc">
                                <p>本系统基于<a href="https://github.com/CGCL-codes/Flash" target="_blank">Flash</a>工具进行Java项目的Gadget Chain检测。Flash首先进行可控性分析，以确定变量是否可以通过反序列化来恢复。然后，它应用一种混合分派方法，根据接收变量的可控性在调用点解析被调用者：如果可控，Flash使用更全面但可能精度较低的技术（例如类层次分析法、代理分派）；否则，则应用更精确的技术（例如指针分析）。Flash还通过处理涉及可控变量的反射来恢复缺失的调用边，并过滤掉不相关的边，以提高准确率和效率</p>
                                <img src="assets/images/java-workflow.jpg" alt="Flash流程图" style="max-width:100%; height:auto; margin-top:10px;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 语言支持 -->
    <section class="section">
        <div class="container">
            <div class="row justify-content-center mb-5">
                <div class="col-lg-8 text-center">
                    <h2 class="section-title fw-bold">已支持语言</h2>
                </div>
            </div>
            <div class="row justify-content-center">
                <!-- Java -->
                <div class="col-lg-3 col-md-4 text-center">
                    <div class="lang-card">
                        <i class="fab fa-java fa-3x mb-3" style="color: #5382A1;"></i>
                        <h4>Java</h4>
                    </div>
                </div>
                
                <!-- PHP -->
                <div class="col-lg-3 col-md-4 text-center">
                    <div class="lang-card">
                        <i class="fab fa-php fa-3x mb-3" style="color: #777BB3;"></i>
                        <h4>PHP</h4>
                    </div>
                </div>
                
                <!-- More -->
                <div class="col-lg-3 col-md-4 text-center">
                    <div class="lang-card">
                        <i class="fas fa-ellipsis-h fa-3x mb-3" style="color: #5F9EA0;"></i>
                        <h4>正在开发</h4>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 工具效果 -->
    <section class="section">
        <div class="container">
            <div class="row justify-content-center mb-5">
                <div class="col-lg-8 text-center">
                    <h2 class="section-title fw-bold">成果展示</h2>
                </div>
            </div>
            <!-- 滑块-->
            <div class="seamless-slider">
                <div class="slider-wrapper">
                    <div class="slider-item active">
                        <div class="row align-items-stretch">
                            <!-- 左侧文字区域 -->
                            <div class="col-lg-6 slider-text">
                                <div class="text-content">
                                    <h3 class="section-title">PHP Gadget Chain检测</h3>
                                    <p class="section-desc">
                                        在31个应用中，PFortifier实现了92.93%的漏洞链总覆盖率，并发现了56条新链，相比于现有技术表现出明显优势
                                    </p>
                                    <p class="section-desc">
                                        相关论文"PFortifier: Mitigating PHP Object Injection Through Automatic Patch Generation"已发表在2025 IEEE Symposium on Security and Privacy (SP)
                                    </p>
                                </div>
                            </div>
                            
                            <!-- 右侧动态表格区域 -->
                            <div class="col-lg-6 dynamic-table-container"
                                 data-json-file="{{ url_for('static', filename='table/php_result.json') }}"
                                 data-table-type="php">
                                <!-- 表格将在这里动态生成 -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- 滑块效果展示 -->
                     <div class="slider-item">
                        <div class="row align-items-stretch">
                            <!-- 左侧文字区域 -->
                            <div class="col-lg-6 slider-text">
                                <div class="text-content">
                                    <h3 class="section-title">Java Gadget Chain检测</h3>
                                    <p class="section-desc">
                                        在已知漏洞链覆盖方面，Flash在基准测试中检测到56条链中的38条，比现有工具多发现8条；在新漏洞链发现方面，Flash共检测到90条未知的漏洞利用链，比现有最先进方法多出55条，表现最优
                                    </p>
                                    <p class="section-desc">
                                        相关论文"Precise and effective gadget chain mining through deserialization guided call graph construction"已发表在Proceedings of the 34th USENIX Conference on Security Symposium
                                    </p>
                                </div>
                            </div>
                            
                            <!-- 右侧动态表格区域 -->
                            <div class="col-lg-6 dynamic-table-container"
                                 data-json-file="{{ url_for('static', filename='table/java_result.json') }}"
                                 data-table-type="java">
                                <!-- 表格将在这里动态生成 -->
                            </div>
                        </div>
                    </div> 
                </div>
                
                <!-- 导航控制 -->
                <div class="slider-navigation">
                    <button class="nav-btn prev-btn">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="nav-dots">
                        <span class="dot active" data-slide="0"></span>
                        <span class="dot" data-slide="1"></span>
                    </div>
                    <button class="nav-btn next-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- 团队介绍 -->
    <section class="section">
        <div class="container">
            <div class="row justify-content-center mb-5">
                <div class="col-lg-8 text-center">
                    <h2 class="section-title fw-bold">未来研究</h2>
                </div>
            </div>
            <div class="row g-4 justify-content-center">
                <!-- 自动化POC生成 -->
                <div class="col-lg-5 col-md-8">
                    <div class="research-card p-5 rounded shadow">
                        <div class="research-icon mb-4">
                            <i class="fas fa-bolt fa-3x" style="color: var(--primary-blue);"></i>
                        </div>
                        <h3 class="fw-bold mb-3">自动化POC生成</h3>
                        <p class="text-muted">
                            研究基于漏洞利用链特征的自动化POC（Proof of Concept）生成技术，通过分析反序列化漏洞链的调用路径和数据依赖关系，自动构造可验证漏洞存在的测试用例。该技术将结合符号执行与模糊测试，实现对复杂漏洞场景的自动验证，提高漏洞验证效率。
                        </p>
                        <p class="mt-3 text-secondary">
                            预期应用：快速验证检测到的漏洞链有效性，支持一键生成可复现的漏洞验证脚本。
                        </p>
                    </div>
                </div>
                
                <!-- 自动化Patch生成 -->
                <div class="col-lg-5 col-md-8">
                    <div class="research-card p-5 rounded shadow">
                        <div class="research-icon mb-4">
                            <i class="fas fa-shield-alt fa-3x" style="color: var(--primary-blue);"></i>
                        </div>
                        <h3 class="fw-bold mb-3">自动化Patch生成</h3>
                        <p class="text-muted">
                            探索基于程序分析的自动化修复技术，针对检测到的反序列化漏洞链，自动生成安全补丁。通过识别漏洞链中的关键调用点和可控输入，采用代码注入、参数校验强化、序列化白名单等策略，在不影响程序正常功能的前提下阻断漏洞利用路径。
                        </p>
                        <p class="mt-3 text-secondary">
                            预期应用：提供漏洞修复建议及自动生成的补丁代码，支持一键应用并验证修复效果。
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/seamless-slider.js') }}"></script>
<script src="{{ url_for('static', filename='js/tech-intro.js') }}"></script>
<script src="{{ url_for('static', filename='js/dynamic-table.js') }}"></script>
{% endblock %}